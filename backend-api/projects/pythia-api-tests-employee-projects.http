###
### Pythia API - Employee Project Assignments Tests
### Base Path: /api/v1/employee-projects
###
### Description: Tests for managing employee assignments to projects
### Author: Pythia Team
### Date: 2025-11-20
###
### This test suite covers:
### - Assigning employees to projects with roles
### - Managing team leads and architects
### - Tracking responsibilities and achievements
### - Querying employee project history
### - Finding available employees for projects
###
### Prerequisites:
### 1. Backend running on http://localhost:8080
### 2. Visionary dataset loaded (20 team assignments)
### 3. 10 employees in database
### 4. 15 projects in database
###

@baseUrl = http://localhost:8080
@apiPath = /api/v1

###############################################################################
### SECTION 1: GET EMPLOYEE PROJECT ASSIGNMENTS
###############################################################################

### 1.1 Get all employee-project assignments
# Expected: 20 assignments from visionary dataset
GET {{baseUrl}}{{apiPath}}/employee-projects
Accept: application/json

###

### 1.2 Get assignments for specific employee (Marcus Chen - ID 1)
# Expected: Multiple projects including QuantumTrade (as Technical Lead)
GET {{baseUrl}}{{apiPath}}/employee-projects/employee/1
Accept: application/json

###

### 1.3 Get assignments for specific employee (Isabella Romano - ID 8)
# Expected: QuantumTrade as Machine Learning Engineer
GET {{baseUrl}}{{apiPath}}/employee-projects/employee/8
Accept: application/json

###

### 1.4 Get team members for specific project (QuantumTrade - ID 1)
# Expected: 4 team members (Marcus Chen, Isabella Romano, Viktor Petrov, Diego Santos)
GET {{baseUrl}}{{apiPath}}/employee-projects/project/1
Accept: application/json

###

### 1.5 Get team members for MediConnect project (ID 2)
# Expected: 3 team members
GET {{baseUrl}}{{apiPath}}/employee-projects/project/2
Accept: application/json

###

### 1.6 Get team members for CityPulse IoT project (ID 3)
# Expected: 3 team members
GET {{baseUrl}}{{apiPath}}/employee-projects/project/3
Accept: application/json

###

###############################################################################
### SECTION 2: GET PROJECT LEADS AND ARCHITECTS
###############################################################################

### 2.1 Get all project leads
# Expected: Multiple leads from visionary dataset
GET {{baseUrl}}{{apiPath}}/employee-projects/leads
Accept: application/json

###

### 2.2 Get all architects
# Expected: Architects from complex projects
GET {{baseUrl}}{{apiPath}}/employee-projects/architects
Accept: application/json

###

### 2.3 Get lead for specific project (QuantumTrade - ID 1)
# Expected: Marcus Chen as Technical Lead & Backend Architect
GET {{baseUrl}}{{apiPath}}/employee-projects/project/1/lead
Accept: application/json

###

###############################################################################
### SECTION 3: CURRENT ASSIGNMENTS
###############################################################################

### 3.1 Get current assignments for employee (Marcus Chen - ID 1)
# Expected: Active projects without end_date
GET {{baseUrl}}{{apiPath}}/employee-projects/employee/1/current
Accept: application/json

###

### 3.2 Get current assignments for employee (Catalina Mora - ID 2)
GET {{baseUrl}}{{apiPath}}/employee-projects/employee/2/current
Accept: application/json

###

### 3.3 Get current team for project (QuantumTrade - ID 1)
# Expected: All 4 current team members
GET {{baseUrl}}{{apiPath}}/employee-projects/project/1/current
Accept: application/json

###

###############################################################################
### SECTION 4: CREATE EMPLOYEE PROJECT ASSIGNMENT
###############################################################################

### 4.1 Assign employee to project as developer
POST {{baseUrl}}{{apiPath}}/employee-projects
Content-Type: application/json
Accept: application/json

{
  "employeeId": 6,
  "projectId": 5,
  "roleDescription": "Blockchain Developer",
  "startDate": "2024-01-15",
  "isLead": false,
  "isArchitect": false,
  "responsibilities": "Smart contract development, Solidity programming, blockchain integration, security audits",
  "achievements": null
}

###

### 4.2 Assign employee as technical lead
POST {{baseUrl}}{{apiPath}}/employee-projects
Content-Type: application/json
Accept: application/json

{
  "employeeId": 1,
  "projectId": 7,
  "roleDescription": "Technical Lead & Game Architecture",
  "startDate": "2024-02-01",
  "isLead": true,
  "isArchitect": true,
  "responsibilities": "Leading game development team, Unity architecture design, multiplayer networking, performance optimization",
  "achievements": null
}

###

### 4.3 Assign multiple employees to new project
# First team member - Project Manager
POST {{baseUrl}}{{apiPath}}/employee-projects
Content-Type: application/json
Accept: application/json

{
  "employeeId": 9,
  "projectId": 11,
  "roleDescription": "Product Manager & Analytics Lead",
  "startDate": "2024-03-01",
  "isLead": true,
  "isArchitect": false,
  "responsibilities": "Product roadmap, stakeholder management, analytics strategy, team coordination",
  "achievements": null
}

###

### 4.4 Second team member - Data Engineer
POST {{baseUrl}}{{apiPath}}/employee-projects
Content-Type: application/json
Accept: application/json

{
  "employeeId": 7,
  "projectId": 11,
  "roleDescription": "Senior Data Engineer",
  "startDate": "2024-03-01",
  "isLead": false,
  "isArchitect": true,
  "responsibilities": "Real-time data pipeline design, Kafka implementation, data warehouse architecture, ETL optimization",
  "achievements": null
}

###

###############################################################################
### SECTION 5: UPDATE EMPLOYEE PROJECT ASSIGNMENT
###############################################################################

### 5.1 Update assignment with achievements
PUT {{baseUrl}}{{apiPath}}/employee-projects/1/1
Content-Type: application/json
Accept: application/json

{
  "achievements": "Designed and implemented scalable microservices architecture handling 100K+ trades/day. Led team of 4 engineers. Reduced API latency by 60% through optimization.",
  "responsibilities": "Leading backend development, microservices architecture design, API development, team mentoring, code reviews, performance optimization"
}

###

### 5.2 Update assignment to mark as lead
PUT {{baseUrl}}{{apiPath}}/employee-projects/2/3
Content-Type: application/json
Accept: application/json

{
  "isLead": true,
  "roleDescription": "Frontend Lead & UX Specialist"
}

###

### 5.3 Complete assignment (set end date)
PUT {{baseUrl}}{{apiPath}}/employee-projects/1/2
Content-Type: application/json
Accept: application/json

{
  "endDate": "2024-09-30",
  "achievements": "Successfully delivered telemedicine platform. Achieved HIPAA compliance. Launched iOS and Android apps with 4.8+ rating."
}

###

###############################################################################
### SECTION 6: REMOVE EMPLOYEE FROM PROJECT
###############################################################################

### 6.1 Remove employee from project
# Note: This is a soft delete - sets end_date to current date
DELETE {{baseUrl}}{{apiPath}}/employee-projects/6/5
Accept: application/json

###

###############################################################################
### SECTION 7: ADVANCED QUERIES
###############################################################################

### 7.1 Get employees by role type
# Search for all "Technical Lead" assignments
GET {{baseUrl}}{{apiPath}}/employee-projects?role=Technical Lead
Accept: application/json

###

### 7.2 Get all Machine Learning Engineers
GET {{baseUrl}}{{apiPath}}/employee-projects?role=Machine Learning Engineer
Accept: application/json

###

### 7.3 Get assignments with achievements
# Filter for completed assignments with documented achievements
GET {{baseUrl}}{{apiPath}}/employee-projects?hasAchievements=true
Accept: application/json

###

### 7.4 Get employee project history (all assignments)
# Useful for generating employee CV/resume
GET {{baseUrl}}{{apiPath}}/employee-projects/employee/1
Accept: application/json

###

### 7.5 Get project team composition
# Useful for project overview and team structure visualization
GET {{baseUrl}}{{apiPath}}/employee-projects/project/1
Accept: application/json

###

###############################################################################
### SECTION 8: VALIDATION TESTS
###############################################################################

### 8.1 Try to assign employee to non-existent project (should fail)
POST {{baseUrl}}{{apiPath}}/employee-projects
Content-Type: application/json
Accept: application/json

{
  "employeeId": 1,
  "projectId": 9999,
  "roleDescription": "Developer",
  "startDate": "2024-01-01",
  "isLead": false,
  "isArchitect": false
}

###

### 8.2 Try to assign non-existent employee (should fail)
POST {{baseUrl}}{{apiPath}}/employee-projects
Content-Type: application/json
Accept: application/json

{
  "employeeId": 9999,
  "projectId": 1,
  "roleDescription": "Developer",
  "startDate": "2024-01-01",
  "isLead": false,
  "isArchitect": false
}

###

### 8.3 Try to create duplicate assignment (should fail or update)
POST {{baseUrl}}{{apiPath}}/employee-projects
Content-Type: application/json
Accept: application/json

{
  "employeeId": 1,
  "projectId": 1,
  "roleDescription": "Duplicate Assignment",
  "startDate": "2023-01-15",
  "isLead": false,
  "isArchitect": false
}

###

