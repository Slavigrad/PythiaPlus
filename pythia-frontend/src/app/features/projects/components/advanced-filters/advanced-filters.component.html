<!-- Advanced Filters Panel -->
<div class="advanced-filters" [class.expanded]="isExpanded()">
  <!-- Panel Header -->
  <header class="filters-header">
    <button
      class="expand-toggle"
      (click)="toggleExpanded()"
      [attr.aria-expanded]="isExpanded()"
      aria-label="Toggle filters panel">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="filter-icon">
        <path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"/>
      </svg>
      <span class="header-title">Advanced Filters</span>
      @if (activeFilterCount() > 0) {
        <span class="filter-count">{{ activeFilterCount() }}</span>
      }
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="expand-icon">
        <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
      </svg>
    </button>

    @if (hasFilters()) {
      <button
        class="clear-all-btn"
        (click)="clearAllFilters()"
        title="Clear all filters"
        aria-label="Clear all filters">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/>
        </svg>
        Clear All
      </button>
    }
  </header>

  <!-- Panel Body -->
  @if (isExpanded()) {
    <div class="filters-body">
      <!-- Status Filter -->
      <section class="filter-section">
        <h4 class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
          </svg>
          Status
        </h4>
        <div class="filter-chips">
          @for (status of statusOptions; track status) {
            <button
              class="filter-chip"
              [class.selected]="isStatusSelected(status)"
              [class]="getStatusClass(status)"
              (click)="toggleStatus(status)"
              type="button"
              role="checkbox"
              [attr.aria-checked]="isStatusSelected(status)">
              {{ status }}
            </button>
          }
        </div>
      </section>

      <!-- Industry Filter -->
      <section class="filter-section">
        <h4 class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 7V3H2v18h20V7H12zM6 19H4v-2h2v2zm0-4H4v-2h2v2zm0-4H4V9h2v2zm0-4H4V5h2v2zm4 12H8v-2h2v2zm0-4H8v-2h2v2zm0-4H8V9h2v2zm0-4H8V5h2v2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8v10zm-2-8h-2v2h2v-2zm0 4h-2v2h2v-2z"/>
          </svg>
          Industry
        </h4>
        <div class="filter-chips">
          @for (industry of industryOptions(); track industry) {
            <button
              class="filter-chip"
              [class.selected]="isIndustrySelected(industry)"
              (click)="toggleIndustry(industry)"
              type="button"
              role="checkbox"
              [attr.aria-checked]="isIndustrySelected(industry)">
              {{ industry }}
            </button>
          }
        </div>
      </section>

      <!-- Technology Filter -->
      <section class="filter-section">
        <h4 class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"/>
          </svg>
          Technology
        </h4>
        <div class="filter-chips">
          @for (tech of technologyOptions(); track tech) {
            <button
              class="filter-chip"
              [class.selected]="isTechnologySelected(tech)"
              (click)="toggleTechnology(tech)"
              type="button"
              role="checkbox"
              [attr.aria-checked]="isTechnologySelected(tech)">
              {{ tech }}
            </button>
          }
        </div>
      </section>

      <!-- Company Filter -->
      <section class="filter-section">
        <h4 class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 7V3H2v18h20V7H12zM6 19H4v-2h2v2zm0-4H4v-2h2v2zm0-4H4V9h2v2zm0-4H4V5h2v2zm4 12H8v-2h2v2zm0-4H8v-2h2v2zm0-4H8V9h2v2zm0-4H8V5h2v2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8v10zm-2-8h-2v2h2v-2zm0 4h-2v2h2v-2z"/>
          </svg>
          Company
        </h4>
        <input
          type="text"
          class="filter-input"
          placeholder="Search by company name..."
          [value]="companyFilter()"
          (input)="onCompanyChange($event)"
          aria-label="Filter by company name"
        />
      </section>

      <!-- Date Range Filter -->
      <section class="filter-section">
        <h4 class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"/>
          </svg>
          Start Date Range
        </h4>
        <div class="date-range-inputs">
          <div class="date-input-wrapper">
            <label for="startDateFrom" class="date-label">From</label>
            <input
              id="startDateFrom"
              type="date"
              class="filter-input date-input"
              [value]="startDateFrom()"
              (input)="onStartDateFromChange($event)"
              aria-label="Start date from"
            />
          </div>
          <div class="date-input-wrapper">
            <label for="startDateTo" class="date-label">To</label>
            <input
              id="startDateTo"
              type="date"
              class="filter-input date-input"
              [value]="startDateTo()"
              (input)="onStartDateToChange($event)"
              aria-label="Start date to"
            />
          </div>
        </div>
      </section>

      <!-- Complexity Filter -->
      <section class="filter-section">
        <h4 class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2l-5.5 9h11z"/>
            <circle cx="17.5" cy="17.5" r="4.5"/>
            <path d="M3 13.5h8v8H3z"/>
          </svg>
          Complexity
        </h4>
        <div class="filter-chips">
          @for (complexity of complexityOptions; track complexity) {
            <button
              class="filter-chip"
              [class.selected]="isComplexitySelected(complexity)"
              [class]="getComplexityClass(complexity)"
              (click)="toggleComplexity(complexity)"
              type="button"
              role="checkbox"
              [attr.aria-checked]="isComplexitySelected(complexity)">
              {{ complexity }}
            </button>
          }
        </div>
      </section>

      <!-- Priority Filter -->
      <section class="filter-section">
        <h4 class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z"/>
          </svg>
          Priority
        </h4>
        <div class="filter-chips">
          @for (priority of priorityOptions; track priority) {
            <button
              class="filter-chip"
              [class.selected]="isPrioritySelected(priority)"
              [class]="getPriorityClass(priority)"
              (click)="togglePriority(priority)"
              type="button"
              role="checkbox"
              [attr.aria-checked]="isPrioritySelected(priority)">
              {{ priority }}
            </button>
          }
        </div>
      </section>

      <!-- Open Positions Toggle -->
      <section class="filter-section">
        <label class="toggle-filter">
          <input
            type="checkbox"
            class="toggle-input"
            [checked]="hasOpenPositions() === true"
            (change)="toggleOpenPositions()"
            aria-label="Show only projects with open positions"
          />
          <span class="toggle-slider"></span>
          <span class="toggle-label">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/>
            </svg>
            Projects with open positions
          </span>
        </label>
      </section>
    </div>
  }
</div>
